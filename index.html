<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Portal Escolar</title>

<style>
body{
margin:0;
font-family:Arial, sans-serif;
background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
color:white;
}
.container{max-width:1200px;margin:auto;padding:30px;}
.box{background:rgba(0,0,0,0.45);padding:20px;border-radius:10px;margin-bottom:20px;}
input,select,button,textarea{width:100%;padding:8px;margin:4px 0;border:none;border-radius:6px;}
button{background:#00c6ff;font-weight:bold;cursor:pointer;}
button:hover{background:#0072ff;}
.hidden{display:none;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
th,td{border:1px solid rgba(255,255,255,0.2);padding:6px;text-align:center;}
th{background:rgba(0,0,0,0.4);}
.reprovado{color:#ff4d4d;font-weight:bold;}
.ouro{color:gold;font-weight:bold;}
.prata{color:silver;font-weight:bold;}
</style>
</head>

<body>
<div class="container">

<div class="box" id="loginBox">
<h2>Login</h2>
<input id="loginUser" placeholder="UsuÃ¡rio">
<input id="loginPass" type="password" placeholder="Senha">
<button onclick="login()">Entrar</button>
<button onclick="showRegister()">Criar conta</button>
</div>

<div class="box hidden" id="registerBox">
<h2>Criar conta</h2>
<input id="regUser">
<input id="regPass" type="password">
<button onclick="register()">Registrar</button>
<button onclick="backLogin()">Voltar</button>
</div>

<div class="hidden" id="siteBox">
<h2>ğŸ“˜ Portal Escolar</h2>

<div class="box hidden" id="adminBox">
<h3>Administrador</h3>

<select id="bimestreAdmin" onchange="carregarNotas()">
<option value="1">1Âº Bimestre</option>
<option value="2">2Âº Bimestre</option>
<option value="3">3Âº Bimestre</option>
<option value="4">4Âº Bimestre</option>
</select>

<div id="userList"></div>
<h4 id="selectedUser"></h4>
<h4>MÃ©dia Geral do Aluno: <span id="mediaAlunoAdmin">--</span></h4>

<h4>ğŸ“‹ Chamada</h4>
<select id="presenca">
<option value="Presente">Presente</option>
<option value="Falta">Falta</option>
</select>

<div id="materiasInputs"></div>
<button onclick="salvarNotas()">Salvar / Atualizar</button>

<hr>
<h3>ğŸ“‰ Alunos em RecuperaÃ§Ã£o</h3>
<div id="recuperacaoAdmin"></div>

<hr>
<h3>ğŸ† Ranking Final (Admin)</h3>
<div id="ranking"></div>
</div>

<div class="box hidden" id="userBox">
<h3 id="userName"></h3>
<div id="boletimAluno"></div>
<h3>MÃ©dia Final Geral: <span id="mediaFinal">--</span></h3>
<button onclick="logout()">Sair</button>
</div>

</div>

<script>
const ADMIN_USER="Joaonetosantana";
const ADMIN_PASS="131210";

const materias=["PortuguÃªs","MatemÃ¡tica","CiÃªncias","HistÃ³ria","Geografia","InglÃªs","EducaÃ§Ã£o FÃ­sica"];

let currentUser="",isAdmin=false,selectedAluno="";

function showRegister(){loginBox.classList.add("hidden");registerBox.classList.remove("hidden");}
function backLogin(){registerBox.classList.add("hidden");loginBox.classList.remove("hidden");}

function register(){
localStorage.setItem("user_"+regUser.value,regPass.value);
alert("Conta criada!");
backLogin();
}

function login(){
if(loginUser.value===ADMIN_USER && loginPass.value===ADMIN_PASS) enter(true,loginUser.value);
else if(localStorage.getItem("user_"+loginUser.value)===loginPass.value) enter(false,loginUser.value);
else alert("Login invÃ¡lido");
}

function enter(a,u){
isAdmin=a; currentUser=u;
loginBox.classList.add("hidden");
registerBox.classList.add("hidden");
siteBox.classList.remove("hidden");
a?loadAdmin():loadAluno();
}

function logout(){location.reload();}

function loadAdmin(){
adminBox.classList.remove("hidden");
userBox.classList.add("hidden");

materiasInputs.innerHTML="";
materias.forEach(m=>{
materiasInputs.innerHTML+=`
<h4>${m}</h4>
<input id="${m}_red" type="number" placeholder="RedaÃ§Ã£o">
<input id="${m}_sim" type="number" placeholder="Simulado">
<input id="${m}_atv" type="number" placeholder="Atividades">
<input id="${m}_prova" type="number" placeholder="Prova">
`;
});

userList.innerHTML="";
Object.keys(localStorage).filter(k=>k.startsWith("user_")).forEach(u=>{
let n=u.replace("user_","");
let b=document.createElement("button");
b.innerText=n;
b.onclick=()=>{selectedAluno=n;selectedUser.innerText="Aluno: "+n;carregarNotas();};
userList.appendChild(b);
});

gerarRanking();
gerarRecuperacao();
}

function carregarNotas(){
if(!selectedAluno) return;
let d=JSON.parse(localStorage.getItem("boletim_"+selectedAluno)||"{}");
let b=bimestreAdmin.value;
presenca.value=d[b]?.presenca||"Presente";

let soma=0,cont=0;
for(let i=1;i<=4;i++){
if(d[i]?.mediaBimestre){soma+=+d[i].mediaBimestre;cont++;}
}
mediaAlunoAdmin.innerText=cont?(soma/cont).toFixed(2):"--";

materias.forEach(m=>{
let x=d[b]?.[m];
document.getElementById(m+"_red").value=x?.red||"";
document.getElementById(m+"_sim").value=x?.sim||"";
document.getElementById(m+"_atv").value=x?.atv||"";
document.getElementById(m+"_prova").value=x?.prova||"";
});
}

function salvarNotas(){
let b=bimestreAdmin.value;
let d=JSON.parse(localStorage.getItem("boletim_"+selectedAluno)||"{}");
d[b]={presenca:presenca.value};
let soma=0,cont=0;

materias.forEach(m=>{
let r=+document.getElementById(m+"_red").value||0;
let s=+document.getElementById(m+"_sim").value||0;
let a=+document.getElementById(m+"_atv").value||0;
let p=+document.getElementById(m+"_prova").value||0;
if(r||s||a||p){
let media=((r+s+a+p)/3).toFixed(2);
d[b][m]={red:r,sim:s,atv:a,prova:p,media};
soma+=+media; cont++;
}
});

d[b].mediaBimestre=cont?(soma/cont).toFixed(2):"--";
localStorage.setItem("boletim_"+selectedAluno,JSON.stringify(d));
alert("Notas salvas!");
gerarRanking();
gerarRecuperacao();
}

function gerarRecuperacao(){
let html="";
Object.keys(localStorage).filter(k=>k.startsWith("user_")).forEach(u=>{
let nome=u.replace("user_","");
let d=JSON.parse(localStorage.getItem("boletim_"+nome)||"{}");
let rec=[];
for(let b=1;b<=4;b++){
materias.forEach(m=>{
if(d[b]?.[m]?.media<6 && !rec.includes(m)) rec.push(m);
});
}
if(rec.length) html+=`<p><b>${nome}</b>: ${rec.join(", ")}</p>`;
});
recuperacaoAdmin.innerHTML=html||"Nenhum aluno em recuperaÃ§Ã£o ğŸ‰";
}

function notaHTML(v){
if(v==="--") return "--";
return `<span class="${v<6?'reprovado':''}">${v}</span>`;
}

function loadAluno(){
adminBox.classList.add("hidden");
userBox.classList.remove("hidden");
userName.innerText="Aluno: "+currentUser;

let d=JSON.parse(localStorage.getItem("boletim_"+currentUser)||"{}");
let html="",sf=0,cf=0;

for(let b=1;b<=4;b++){
let mb=d[b]?.mediaBimestre||"--";
let alamar=mb>=9?'<span class="ouro">ğŸ… Ouro</span>':mb>=8?'<span class="prata">ğŸ¥ˆ Prata</span>':"";
html+=`<h3>${b}Âº Bimestre ${alamar}</h3>
<p>ğŸ“‹ Chamada: ${d[b]?.presenca||"--"}</p>
<table>
<tr><th>MatÃ©ria</th><th>Red</th><th>Sim</th><th>Atv</th><th>Prova</th><th>MÃ©dia</th></tr>`;

materias.forEach(m=>{
let x=d[b]?.[m];
html+=`
<tr>
<td>${m}</td>
<td>${x?.red??"--"}</td>
<td>${x?.sim??"--"}</td>
<td>${x?.atv??"--"}</td>
<td>${x?.prova??"--"}</td>
<td>${notaHTML(x?.media??"--")}</td>
</tr>`;
});

html+=`<tr><th colspan="5">MÃ©dia do Bimestre</th><th>${notaHTML(mb)}</th></tr></table>`;
if(mb!=="--"){sf+=+mb;cf++;}
}

boletimAluno.innerHTML=html;
mediaFinal.innerHTML=notaHTML(cf?(sf/cf).toFixed(2):"--");
}

function gerarRanking(){
let alunos=Object.keys(localStorage).filter(k=>k.startsWith("user_")).map(u=>{
let n=u.replace("user_","");
let d=JSON.parse(localStorage.getItem("boletim_"+n)||"{}");
let s=0,c=0;
for(let b=1;b<=4;b++){
if(d[b]?.mediaBimestre){s+=+d[b].mediaBimestre;c++;}
}
return {nome:n,media:c?(s/c):0};
}).sort((a,b)=>b.media-a.media);

ranking.innerHTML=alunos.slice(0,3)
.map((a,i)=>`${i+1}Âº - ${a.nome} (${a.media.toFixed(2)})`)
.join("<br>");
}
</script>
</body>
</html>

